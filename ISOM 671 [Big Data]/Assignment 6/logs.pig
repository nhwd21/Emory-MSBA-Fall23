-- load weblog file from S3 .txt into pig tableweblog_data = LOAD 's3://fm-ga2/access_log_Jul95.txt' USING PigStorage(' ') AS (    ipaddress:chararray,    hyphen1:chararray,    hyphen2:chararray,    time:chararray,    timezone:chararray,    request1:chararray,	request2:chararray,    request3:chararray,    status_code:int,    data_size:int);-- combine and clean up columns to retrieve the necessary fieldsparsed_data = FOREACH weblog_data GENERATE	ipaddress,	FLATTEN(SUBSTRING(StringConcat(time, ' ', timezone), 1, (int)SIZE(StringConcat(time, ' ', timezone))-1)) AS timestamp,	FLATTEN(SUBSTRING(StringConcat(request1, ' ', request2, ' ', request3), 1, (int)SIZE(StringConcat(request1, ' ', request2, ' ', request3))-1)) AS request,	status_code,	data_size;-- store the cleaned data in hdfsSTORE parsed_data INTO 'hdfs:/user/hadoop/weblog_clean' USING PigStorage(',');